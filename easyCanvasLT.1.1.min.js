/*!
 *	EasyCanvasLT (light) version 1.1
 *	Ken Fyrstenberg Nilsen, (c) 2013 Abidas Software
 *	http://abdiassoftware.com
 *	GPL-3.0 license (http://opensource.org/licenses/GPL-3.0
*/
"use strict";function easyCanvasLT(){var u=this,m,s,c,q=0,n=0,o=0,v=0,r=0,b=!0,t=!0,e=25;this.canvas=null;this.onmousedown=null;this.onmousemove=null;this.onmouseup=null;this.onredraw=null;this.deltaX=0;this.deltaY=0;this.reportResize=!0;this.autoResize=!1;this.trackMove=!1;this.clearColor=null;this.clearBeforeDraw=!0;this.width;this.height;this.firstX=-1;this.firstY=-1;this.prevX=-1;this.prevY=-1;this.prevStamp=null;this.count=0;this.isDown=!1;if(arguments.length>0){for(;r<arguments.length;r++){if(typeof arguments[r]==="number"){if(t===!0){this.width=m=parseInt(arguments[r]);t=!1}else{this.height=s=parseInt(arguments[r])}}if(typeof arguments[r]==="string"){c=document.getElementById(arguments[r]);if(c instanceof HTMLCanvasElement){this.canvas=c;this.width=this.canvas.width;this.height=this.canvas.height}}if(arguments[r] instanceof HTMLCanvasElement){this.canvas=arguments[r];this.width=this.canvas.width;this.height=this.canvas.height}if(arguments[r] instanceof HTMLElement){c=arguments[r]}}}this.resize=function(i,x){if(typeof i!=="number"||typeof x!=="number"){throw"Illegal numbers for width or height."}try{this.canvas.width=parseInt(i,"10")-(q+o);this.canvas.height=parseInt(x,"10")-(n+v);this.canvas.style.left=q+"px";this.canvas.style.top=n+"px";this.width=this.canvas.width;this.height=this.canvas.height;if(this.ctx!==undefined){a();setTransform()}p()}catch(y){console.error(y)}return this};this.padding=function(x,i,h,w){if(parameters.length===0){return[n,o,v,q]}n=x;o=i;v=h;q=w;this.resize(this.width,this.height);return this};this.clear=function(){var h=this.ctx;h.save();h.setTransform(1,0,0,1,0,0);if(this.clearColor===null){h.clearRect(0,0,this.canvas.width,this.canvas.height)}else{h.fillStyle=this.clearColor;h.fillRect(0,0,this.canvas.width,this.canvas.height)}h.restore();return this};this.remove=function(){try{if(typeof c!=="undefined"&&c!==null&&typeof c!=="string"){window.removeEventListener("resize",j,!1);window.removeEventListener("mouseup",d,!1);if(b===!0){window.removeEventListener("mousemove",g,!1)}this.canvas.onmousedown=null;this.canvas.onmousemove=null;this.canvas.onmouseup=null;if(!(c instanceof HTMLCanvasElement)){c.removeChild(this.canvas)}this.ctx=undefined;this.canvas=undefined}}catch(h){console.error(h)}};this.download=function(i,x,h){if(typeof i!=="string"||i.trim().length===0){i="Untitled"}x=(typeof x==="string")?x.toLowerCase():"png";if(i.length<5||i.substring(i.length-x.length)!==x){i+="."+x}var z=document.createElement("a"),y=this.canvas,w;z.download=i;if(x==="png"){z.href=y.toDataURL()}else{if(x==="jpg"||x==="jpeg"){(typeof h==="number")?z.href=y.toDataURL("image/jpeg",h):z.href=y.toDataURL("image/jpeg")}}if(document.createEvent){w=document.createEvent("MouseEvents");w.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);z.dispatchEvent(w)}else{if(z.fireEvent){z.fireEvent("onclick")}}return this};this.clipCoords=function(h){if(typeof h!=="boolean"){return !b}if(h!==b){return this}if(h===!0){window.removeEventListener("mousemove",g,!1);this.canvas.onmousemove=g}else{this.canvas.onmousemove=null;window.addEventListener("mousemove",g,!1)}b=!h;return this};this.update=function(){p()};this.getOffscreenCanvas=function(y,z){if(arguments.length!==2){y=this.width;z=this.height}var A=document.createElement("canvas"),i;A.width=y;A.height=z;i=A.getContext("2d");return{canvas:A,ctx:i,context:i,width:y,height:z,centerX:y*0.5,centerY:z*0.5}};this.strokeLine=function(y,A,x,z,B,w){var i=this.ctx,h=arguments.length;i.beginPath();i.moveTo(y,A);i.lineTo(x,z);if(h>4){i.lineWidth=B}if(h>5){i.strokeStyle=w}i.stroke();return this};function p(){if(u.onredraw!==null){if(u.clearBeforeRedraw===!0){u.clear()}u.onredraw(!1)}}function a(){var h=getComputedStyle(u.canvas);u.deltaX=parseInt(h.getPropertyValue("padding-left"),10)+parseInt(h.getPropertyValue("border-left-width"),10);u.deltaY=parseInt(h.getPropertyValue("padding-top"),10)+parseInt(h.getPropertyValue("border-top-width"),10);if(isNaN(u.deltaX)===!0){u.deltaX=0}if(isNaN(u.deltaY)===!0){u.deltaY=0}}function l(h,w){var i=u.canvas.getBoundingClientRect();h=(h-i.left-u.deltaX);w=(w-i.top-u.deltaY);return[h,w]}try{if(this.canvas===null){this.canvas=document.createElement("canvas");if(typeof this.canvas==="undefined"){throw"Could not create a canvas element."}if(typeof m!=="number"||typeof s!=="number"){this.canvas.style.position="fixed";this.canvas.style.left="0";this.canvas.style.top="0";this.resize(window.innerWidth,window.innerHeight);this.autoResize=!0}else{this.canvas.width=this.width;this.canvas.height=this.height}}else{c=null}a();this.ctx=this.context=this.canvas.getContext("2d");if(typeof this.ctx==="undefined"){throw"Could not create a 2D canvas context."}if(c!==null){if(typeof c==="undefined"){c=document.getElementsByTagName("body")[0]}if(typeof c==="undefined"){throw"No element is defined (body seem unavailable)"}c.appendChild(this.canvas)}}catch(f){console.error(f)}window.addEventListener("resize",j,!1);window.addEventListener("mouseup",d,!1);window.addEventListener("mousemove",g,!1);function j(h){if(u.reportResize===!0){if(u.autoResize===!0){u.resize(window.innerWidth,window.innerHeight)}else{p()}}}this.canvas.onmousedown=function(w){var i=l(w.clientX,w.clientY),h=i[0],z=i[1];u.firstX=u.prevX=h;u.firstY=u.prevY=z;u.prevStamp=w.timeStamp;u.count=1;u.isDown=!0;if(u.onmousedown!==null){u.onmousedown(h,z,w)}};function g(w){var z=u,i,h,A;if(z.isDown===!0||z.trackMove===!0){i=l(w.clientX,w.clientY);h=i[0];A=i[1];z.count++;w.isMouseDown=z.isDown;if(z.onmousemove!==null){z.onmousemove(h,A,w)}z.prevStamp=w.timeStamp;z.prevX=h;z.prevY=A}}function d(w){var i=l(w.clientX,w.clientY),h=i[0],z=i[1];if(u.isDown===!0){u.isDown=!1;w.count=u.count;if(u.onmouseup!==null){u.onmouseup(h,z,w)}}}function k(){if(u.onredraw===null){e--;if(e>0){setTimeout(k,10)}}else{u.clear();u.onredraw(!1)}}k();return this}window.requestAnimationFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,16)}})();